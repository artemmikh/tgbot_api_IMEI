# Telegram Bot for IMEI Check

## Описание

Данный проект представляет собой Telegram-бота, который позволяет проверять
валидность IMEI устройств. Бот интегрирован с внешним сервисом проверки IMEI и
предоставляет API для взаимодействия с другими системами. В этом проекте
реализована базовая функциональность с использованием FastAPI и Telegram-бота.

## Установка и настройка

1. Клонируйте репозиторий на ваш компьютер:
    ```bash
    git clone https://github.com/artemmikh/tgbot_api_IMEI.git
    ```

2. Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```

3. Создайте файл `.env` в директории /imei_bot и добавьте следующие переменные
   окружения:
    ```
    BOT_TOKEN=<example>
    API_URL=<example>
    IMEI_CHECK_API_URL=<example>
    USER_CHECK_API_URL=<example>
    ```

3. Создайте файл `.env` в директории /imei_api и добавьте следующие переменные
   окружения:
    ```
    TOKEN_API_SANDBOX=<example>
    TOKEN_API_LIVE=<example>
    APP_TITLE=<example>
    DESCRIPTION=<example>
    DATABASE_URL=<example>
    IMEI_CHECK_URL=<example>
    SANDBOX_MODE=<example>
    ```
   укажите SANDBOX_MODE=True если хотите отправлять запросы к внешнему api
   в режиме "песочницы".

## Telegram-бот

Бот предоставляет простой интерфейс для взаимодействия с пользователем. Он
принимает IMEI от пользователя, проверяет его валидность и отправляет ответ с
информацией о устройстве.

### Команды:

- `/start` — приветственное сообщение и инструкция по использованию бота.
- Отправьте IMEI в чат, и бот проверит его.

## Внешний сервис для проверки IMEI

Для проверки IMEI используется сервис [IMEI Check](https://imeicheck.net/). Для
работы с API необходимо использовать токен, который можно получить при
регистрации.

Документация по API доступна [здесь](https://imeicheck.net/promo-api).

## API

### 1. Регистрация пользователя

Для регистрации пользователя и получения токена используйте API-метод:

**POST** `/register`

**Тело запроса:**

- `username` (строка, обязательный) — имя пользователя.
- `tg_username` (строка, необязательный) — телеграм-юзернейм.

**Ответ:**

- Возвращает объект с данными пользователя, включая токен.

### 2. Добавление Telegram username к пользователю

Для добавления телеграм-юзернейма к существующему пользователю используйте
API-метод:

**POST** `/register/add_tg_username`

**Параметры запроса:**

- `username` (строка, обязательный) — имя зарегистрированного пользователя.
- `tg_username` (строка, обязательный) — телеграм-юзернейм.

**Ответ:**

- Возвращает обновленные данные пользователя.

### 3. Проверка IMEI

Для проверки IMEI используйте API-метод:

**POST** `/check_imei`

**Параметры запроса:**

- `imei` (строка, обязательный) — IMEI устройства.
- `token` (строка, обязательный) — токен авторизации.

**Ответ:**

- Возвращает информацию о IMEI.

### 4. Получение данных пользователя по Telegram username

Для получения данных пользователя по Telegram username используйте API-метод:

**GET** `/register`

**Параметры запроса:**

- `tg_username` (строка, обязательный) — Telegram username.

**Ответ:**

- Возвращает данные пользователя, включая токен.

